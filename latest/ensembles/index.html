<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Ensembles · GeometricEquations.jl</title><meta name="title" content="Ensembles · GeometricEquations.jl"/><meta property="og:title" content="Ensembles · GeometricEquations.jl"/><meta property="twitter:title" content="Ensembles · GeometricEquations.jl"/><meta name="description" content="Documentation for GeometricEquations.jl."/><meta property="og:description" content="Documentation for GeometricEquations.jl."/><meta property="twitter:description" content="Documentation for GeometricEquations.jl."/><meta property="og:url" content="https://JuliaGNI.github.io/GeometricEquations.jl/ensembles/"/><meta property="twitter:url" content="https://JuliaGNI.github.io/GeometricEquations.jl/ensembles/"/><link rel="canonical" href="https://JuliaGNI.github.io/GeometricEquations.jl/ensembles/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GeometricEquations.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../equations/">Equations</a></li><li><a class="tocitem" href="../problems/">Problems</a></li><li class="is-active"><a class="tocitem" href>Ensembles</a><ul class="internal"><li><a class="tocitem" href="#Ordinary-Differential-Equation-Ensembles"><span>Ordinary Differential Equation Ensembles</span></a></li></ul></li><li><a class="tocitem" href="../reference/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Ensembles</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Ensembles</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGNI/GeometricEquations.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGNI/GeometricEquations.jl/blob/main/docs/src/ensembles.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Ensembles"><a class="docs-heading-anchor" href="#Ensembles">Ensembles</a><a id="Ensembles-1"></a><a class="docs-heading-anchor-permalink" href="#Ensembles" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeometricEquations.EnsembleProblem" href="#GeometricEquations.EnsembleProblem"><code>GeometricEquations.EnsembleProblem</code></a> — <span class="docstring-category">Type</span></header><section><div><p>EnsembleProblem: stores a GeometricEquation together with multiple sets of initial conditions and/or parameters, a time span for integration and a time step size.</p><p>An <code>EnsembleProblem</code> is initialized by providing a <code>GeometricEquation</code>, an integration time span (typically a tuple with two values, start and end time, respectively), a timestep, and one of the three following options:</p><ul><li>a vector of initial conditions and a vector of parameter sets, with both vectors having the same length,</li><li>a vector of initial conditions and a single set of parameters,</li><li>a single initial condition and a vector of parameter sets.</li></ul><p>Each initial condition is a <code>NamedTuple</code> that contains one field for each state variable. Each parameter set is either a <code>NamedTuple</code> containing the equation&#39;s parameters or <code>NullParameters</code> indicating that the equation does not have any parameters.</p><p>The different constructors then generate two vectors, one for the initial conditions and one for the parameters, where each pair of the corresponding entries defines one problem. In the first case, the respective constructor just checks if both vectors are of the same size. In the second case, the respective constructor creates a parameter vector, where each entry holds the same parameter set. In the third case, the respective constructor creates an initial condition vector, where each entry holds the same initial conditions. One may be inclined to think that the first and second constructor lead to a waste of memory, but in reality the respective vectors only hold references to the same initial conditons or parameters. Thus the data is not actually duplicated.</p><p>Each pair of initial conditions and parameters is referred to as sample. The methods</p><pre><code class="nohighlight hljs">length(::EnsembleProblem)
nsamples(::EnsembleProblem)</code></pre><p>return the number of samples in a <code>EnsembleProblem</code>. A single initial condition or parameter set can be retrieved by the methods</p><pre><code class="nohighlight hljs">initial_condition(::EnsembleProblem, i)
parameter(::EnsembleProblem, i)</code></pre><p>where <code>i</code> is the index of the sample. Typically, however, e.g. when integrating all samples of an <code>EnsembleProblem</code> with GeometricIntegrators, it is more convenient to retrieve the corresponding <code>GeometricProblem</code> via the method</p><pre><code class="nohighlight hljs">problem(::EnsembleProblem, i)</code></pre><p>The <code>EnsembleProblem</code> also allows to iterate over all samples, e.g.</p><pre><code class="nohighlight hljs">for problem in ensemble
    # ...
    # integrate problem
    # ...
end</code></pre><p>where <code>ensemble</code> is an <code>EnsembleProblem</code> and <code>problem</code> is the corresponding <code>GeometricProblem</code>.</p><p><strong>Parameters</strong></p><ul><li><code>ST &lt;: GeometricEquation</code>: super type, used for dispatch</li><li><code>DT &lt;: Number</code>: data type</li><li><code>TT &lt;: Real</code>: time step type</li><li><code>AT &lt;: AbstractArray{DT}</code>: array type of state variable</li><li><code>equType &lt;: GeometricEquation</code>: equation type</li><li><code>functionsType &lt;: NamedTuple</code>: types of all function methods</li><li><code>solutionsType &lt;: NamedTuple</code>: types of all solution methods</li><li><code>icsType &lt;: AbstractVector{&lt;:NamedTuple}</code>: types of all initial conditions </li><li><code>parType &lt;: AbstractVector{&lt;:OptionalParameters}</code>: parameters type</li></ul><p><strong>Fields</strong></p><ul><li><code>equation</code>: reference to the parent equation object holding the vector fields, etc.</li><li><code>functions</code>: methods for all vector fields, etc., that define the problem</li><li><code>solutions</code>: methods for all solutions, etc., if defined</li><li><code>tspan</code>: time span for problem <code>(t₀,t₁)</code></li><li><code>tstep</code>: time step to be used in simulation</li><li><code>ics</code>: vector of <code>NamedTuple</code> containing the initial conditions, each <code>NamedTuple</code> must contain one field for each state variable</li><li><code>parameters</code>: vector of either <code>NamedTuple</code> containing the equation&#39;s parameters or <code>NullParameters</code> indicating that the equation does not have any parameters</li></ul><p><strong>Constructors</strong></p><p>The <code>EnsembleProblem</code> provides the following constructors:</p><pre><code class="nohighlight hljs">EnsembleProblem(equ, tspan, tstep, ics::AbstractVector{&lt;:NamedTuple}, parameters::AbstractVector{&lt;:OptionalParameters})
EnsembleProblem(equ, tspan, tstep, ics::AbstractVector{&lt;:NamedTuple}, parameters::OptionalParameters=NullParameters())
EnsembleProblem(equ, tspan, tstep, ics::NamedTuple, parameters::AbstractVector{&lt;:OptionalParameters})
EnsembleProblem(equ, tspan, tstep, ics, ::Nothing) = 
    EnsembleProblem(equ, tspan, tstep, ics, NullParameters())
EnsembleProblem(equ, tspan, tstep, ics; parameters = NullParameters()) = 
    EnsembleProblem(equ, tspan, tstep, ics, parameters)</code></pre><ul><li><code>equ</code> is a subtype of <code>GeometricEquation</code></li><li><code>tspan</code> is a tuple <code>(t₀,t₁)</code> of the integration time span with <code>t₀</code> the start time and <code>t₁</code> the end time</li><li><code>tstep</code> is the time step, typically a value of some <code>AbstractFloat</code> subtype</li><li><code>ics</code> are the initial conditions, either a single set or a vector of multiple sets</li><li><code>parameters</code> are the static parameters of the problem, either a single set or a vector of multiple sets</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGNI/GeometricEquations.jl/blob/291b4c440a1df9649bf3bd52b0347eb887c037eb/src/problems/ensemble_problem.jl#L1-L88">source</a></section></article><h2 id="Ordinary-Differential-Equation-Ensembles"><a class="docs-heading-anchor" href="#Ordinary-Differential-Equation-Ensembles">Ordinary Differential Equation Ensembles</a><a id="Ordinary-Differential-Equation-Ensembles-1"></a><a class="docs-heading-anchor-permalink" href="#Ordinary-Differential-Equation-Ensembles" title="Permalink"></a></h2><ul><li><a href="#GeometricEquations.ODEEnsemble"><code>ODEEnsemble</code></a></li><li><a href="#GeometricEquations.PODEEnsemble"><code>PODEEnsemble</code></a></li><li><a href="#GeometricEquations.HODEEnsemble"><code>HODEEnsemble</code></a></li><li><a href="#GeometricEquations.IODEEnsemble"><code>IODEEnsemble</code></a></li><li><a href="#GeometricEquations.LODEEnsemble"><code>LODEEnsemble</code></a></li><li><a href="#GeometricEquations.SODEEnsemble"><code>SODEEnsemble</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeometricEquations.ODEEnsemble" href="#GeometricEquations.ODEEnsemble"><code>GeometricEquations.ODEEnsemble</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>ODEEnsemble</code>: Ordinary Differential Equation Ensemble</p><p>Ordinary differential equations define an initial value problem of the form</p><p class="math-container">\[\dot{q} (t) = v(t, q(t)) ,\]</p><p>with vector field <span>$v$</span>.</p><p>The dynamical variables <span>$q$</span> take values in <span>$\mathbb{R}^{d}$</span>.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">ODEEnsemble(v, tspan, tstep, ics::AbstractVector{&lt;: NamedTuple}; kwargs...)
ODEEnsemble(v, tspan, tstep, q₀::AbstractVector{&lt;: StateVariable}; kwargs...)
ODEEnsemble(v, tspan, tstep, q₀::AbstractVector{&lt;: AbstractArray}; kwargs...)</code></pre><p>where <code>v</code> is the function computing the vector field,  <code>tspan</code> is the time interval <code>(t₀,t₁)</code> for the problem to be solved in, <code>tstep</code> is the time step to be used in the simulation, and  <code>ics</code> is an <code>AbstractVector</code> of <code>NamedTuple</code>, each with an entry <code>q</code> of type <code>StateVariable</code>. The initial condition <code>q₀</code> can also be prescribed as an <code>AbstractVector</code> of <code>StateVariable</code> or <code>AbstractArray{&lt;:Number}</code>. For the interface of the function <code>v</code> see <a href="../equations/#GeometricEquations.ODE"><code>ODE</code></a>.</p><p>For possible keyword arguments see the documentation on <a href="#GeometricEquations.EnsembleProblem"><code>EnsembleProblem</code></a> subtypes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGNI/GeometricEquations.jl/blob/291b4c440a1df9649bf3bd52b0347eb887c037eb/src/odes/ode.jl#L182-L207">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeometricEquations.PODEEnsemble" href="#GeometricEquations.PODEEnsemble"><code>GeometricEquations.PODEEnsemble</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>PODEEnsemble</code>: Partitioned Ordinary Differential Equation Ensemble</p><p>A partitioned ordinary differential equation is an initial value problem of the form</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t, q(t), p(t)) , \\
\dot{p} (t) &amp;= f(t, q(t), p(t)) ,
\end{aligned}\]</p><p>with vector fields <span>$v$</span> and <span>$f$</span>.</p><p>The dynamical variables <span>$(q,p)$</span> take values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">PODEEnsemble(v, f, tspan, tstep, ics::AbstractVector{&lt;: NamedTuple}; kwargs...)
PODEEnsemble(v, f, tspan, tstep, q₀::AbstractVector{&lt;: StateVariable}, p₀::AbstractVector{&lt;: StateVariable}; kwargs...)
PODEEnsemble(v, f, tspan, tstep, q₀::AbstractVector{&lt;: AbstractArray}, p₀::AbstractVector{&lt;: AbstractArray}; kwargs...)</code></pre><p>where <code>v</code> and <code>f</code> are the function computing the vector fields,  <code>tspan</code> is the time interval <code>(t₀,t₁)</code> for the problem to be solved in, <code>tstep</code> is the time step to be used in the simulation, and <code>ics</code> is an <code>AbstractVector</code> of <code>NamedTuple</code>, each with entries <code>q</code> and <code>p</code>. The initial conditions <code>q₀</code> and <code>p₀</code> can also be prescribed, each as an <code>AbstractVector</code> of <code>StateVariable</code> or <code>AbstractArray{&lt;:Number}</code>. For the interfaces of the functions <code>v</code> and <code>f</code> see <a href="../equations/#GeometricEquations.PODE"><code>PODE</code></a>.</p><p>For possible keyword arguments see the documentation on <a href="#GeometricEquations.EnsembleProblem"><code>EnsembleProblem</code></a> subtypes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGNI/GeometricEquations.jl/blob/291b4c440a1df9649bf3bd52b0347eb887c037eb/src/odes/pode.jl#L199-L223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeometricEquations.HODEEnsemble" href="#GeometricEquations.HODEEnsemble"><code>GeometricEquations.HODEEnsemble</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>HODEEnsemble</code>: Hamiltonian Ordinary Differential Equation Ensemble</p><p>A canonical Hamiltonian system of equations is special case of a partitioned ordinary differential equation,</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t, q(t), p(t)) , \\
\dot{p} (t) &amp;= f(t, q(t), p(t)) ,
\end{aligned}\]</p><p>with vector fields <span>$v$</span> and <span>$f$</span>, given by</p><p class="math-container">\[\begin{aligned}
v &amp;=   \frac{\partial H}{\partial p} , &amp;
f &amp;= - \frac{\partial H}{\partial q} .
\end{aligned}\]</p><p>The dynamical variables <span>$(q,p)$</span> take values in <span>$T^{*} Q \simeq \mathbb{R}^{d} \times \mathbb{R}^{d}$</span>.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">HODEEnsemble(v, f, hamiltonian, tspan, tstep, ics::AbstractVector{&lt;: NamedTuple}; kwargs...)
HODEEnsemble(v, f, hamiltonian, tspan, tstep, q₀::AbstractVector{&lt;: StateVariable}, p₀::AbstractVector{&lt;: StateVariable}; kwargs...)
HODEEnsemble(v, f, hamiltonian, tspan, tstep, q₀::AbstractVector{&lt;: AbstractArray}, p₀::AbstractVector{&lt;: AbstractArray}; kwargs...)</code></pre><p>where <code>v</code> and <code>f</code> are the function computing the vector fields,  <code>hamiltonian</code> returns the value of the Hamiltonian (i.e. the total energy), <code>tspan</code> is the time interval <code>(t₀,t₁)</code> for the problem to be solved in, <code>tstep</code> is the time step to be used in the simulation, and <code>ics</code> is an <code>AbstractVector</code> of <code>NamedTuple</code>, each with entries <code>q</code> and <code>p</code>. The initial conditions <code>q₀</code> and <code>p₀</code> can also be prescribed, each as an <code>AbstractVector</code> of <code>StateVariable</code> or <code>AbstractArray{&lt;:Number}</code>. For the interfaces of the functions <code>v</code>, <code>f</code> and <code>hamiltonian</code> see <a href="../equations/#GeometricEquations.HODE"><code>HODE</code></a>.</p><p>For possible keyword arguments see the documentation on <a href="#GeometricEquations.EnsembleProblem"><code>EnsembleProblem</code></a> subtypes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGNI/GeometricEquations.jl/blob/291b4c440a1df9649bf3bd52b0347eb887c037eb/src/odes/hode.jl#L229-L254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeometricEquations.IODEEnsemble" href="#GeometricEquations.IODEEnsemble"><code>GeometricEquations.IODEEnsemble</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>IODEEnsemble</code>: Implicit Ordinary Differential Equation Ensemble</p><p>An implicit ordinary differential equations is an initial value problem of the form</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) , \\
p(t) &amp;= ϑ(t, q(t), v(t)) ,
\end{aligned}\]</p><p>with force field <span>$f$</span>, the momentum defined by <span>$p$</span>. This is a special case of a differential algebraic equation with dynamical variables <span>$(q,p)$</span> and algebraic variable <span>$v$</span>, that is determined such that the constraint <span>$p(t) = ϑ(t, q(t), v(t))$</span> is satisfied.</p><p>Most integrators perform a projection step in order to enforce this constraint. To this end, the system is extended to</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) + λ(t) , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) + g(t, q(t), v(t), λ(t)) , \\
p(t) &amp;= ϑ(t, q(t), v(t)) ,
\end{aligned}\]</p><p>where the vector field defining the projection step is usually given as</p><p class="math-container">\[\begin{aligned}
g(t, q(t), v(t), λ(t)) &amp;= λ(t) \cdot \nabla ϑ(t, q(t), v(t)) .
\end{aligned}\]</p><p>The dynamical variables <span>$(q,p)$</span> take values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>. The algebraic variable <span>$λ$</span> takes values in <span>$\mathbb{R}^{m}$</span>.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">IODEEnsemble(ϑ, f, tspan, tstep, ics::AbstractVector{&lt;: NamedTuple}; kwargs...)
IODEEnsemble(ϑ, f, tspan, tstep, q₀::AbstractVector{&lt;: StateVariable}, p₀::AbstractVector{&lt;: StateVariable}, λ₀::AbstractVector{&lt;: AlgebraicVariable}; kwargs...)
IODEEnsemble(ϑ, f, tspan, tstep, q₀::AbstractVector{&lt;: AbstractArray}, p₀::AbstractVector{&lt;: AbstractArray}, λ₀::AbstractVector{&lt;: AbstractArray}; kwargs...)
IODEEnsemble(ϑ, f, g, tspan, tstep, ics::AbstractVector{&lt;: NamedTuple}; kwargs...)
IODEEnsemble(ϑ, f, g, tspan, tstep, q₀::AbstractVector{&lt;: StateVariable}, p₀::AbstractVector{&lt;: StateVariable}, λ₀::AbstractVector{&lt;: AlgebraicVariable}; kwargs...)
IODEEnsemble(ϑ, f, g, tspan, tstep, q₀::AbstractVector{&lt;: AbstractArray}, p₀::AbstractVector{&lt;: AbstractArray}, λ₀::AbstractVector{&lt;: AbstractArray}; kwargs...)</code></pre><p>The functions <code>ϑ</code>, <code>f</code> and <code>g</code> compute the momentum and the vector fields, respectively.</p><p><code>tspan</code> is the time interval <code>(t₀,t₁)</code> for the problem to be solved in, <code>tstep</code> is the time step to be used in the simulation, and <code>ics</code> is a <code>NamedTuple</code> with entries <code>q</code>, <code>p</code> and <code>λ</code>. <code>ics</code> is an <code>AbstractVector</code> of <code>NamedTuple</code>, each with entries <code>q</code>, <code>p</code> and <code>λ</code>. The initial conditions <code>q₀</code>, <code>p₀</code> and <code>λ₀</code> can also be prescribed, each as an <code>AbstractVector</code> of <code>StateVariable</code> or <code>AbstractArray{&lt;:Number}</code>. For the interfaces of the functions <code>ϑ</code>, <code>f</code> and <code>g</code> see <a href="../equations/#GeometricEquations.IODE"><code>IODE</code></a>.</p><p>In addition to the standard keyword arguments for <a href="../problems/#GeometricEquations.EquationProblem"><code>EquationProblem</code></a> subtypes, an <code>IODEEnsemble</code> accepts functions <code>v̄</code> and <code>f̄</code> for the computation of initial guesses for the vector fields with default values <code>v̄ = _iode_default_v̄</code> and <code>f̄ = f</code>.</p><p>For possible keyword arguments see the documentation on <a href="#GeometricEquations.EnsembleProblem"><code>EnsembleProblem</code></a> subtypes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGNI/GeometricEquations.jl/blob/291b4c440a1df9649bf3bd52b0347eb887c037eb/src/odes/iode.jl#L302-L337">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeometricEquations.LODEEnsemble" href="#GeometricEquations.LODEEnsemble"><code>GeometricEquations.LODEEnsemble</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>LODEEnsemble</code>: Lagrangian Ordinary Differential Equation Ensemble</p><p>A Lagrangian system of equations is a special case of an implicit ordinary differential equations, that is an implicit initial value problem of the form</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) , \\
p(t) &amp;= ϑ(t, q(t), v(t)) ,
\end{aligned}\]</p><p>with momentum <span>$p$</span> and force field <span>$f$</span>, given by</p><p class="math-container">\[\begin{aligned}
p &amp;= \frac{\partial L}{\partial v} , &amp;
f &amp;= \frac{\partial L}{\partial q} .
\end{aligned}\]</p><p>This is a special case of an implicit ordinary differential equation, that is defined by a Lagrangian, as well as a special case of a differential algebraic equation with dynamical variables <span>$(q,p)$</span> and algebraic variable <span>$v$</span>, that is determined such that the constraint <span>$p(t) = ϑ(t, q(t), v(t))$</span> is satisfied.</p><p>Many integrators perform a projection step in order to enforce this constraint. To this end, the system is extended to</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) + \lambda(t) , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) + g(t, q(t), v(t), \lambda(t)) , \\
p(t) &amp;= ϑ(t, q(t), v(t)) ,
\end{aligned}\]</p><p>where the vector field defining the projection step is usually given as</p><p class="math-container">\[\begin{aligned}
g(t, q(t), v(t), λ(t)) &amp;= λ(t) \cdot \nabla ϑ(t, q(t), v(t)) .
\end{aligned}\]</p><p>The dynamical variables <span>$(q,p)$</span> take values in <span>$T^{*} Q \simeq \mathbb{R}^{d} \times \mathbb{R}^{d}$</span>. The algebraic variable <span>$λ$</span> takes values in <span>$\mathbb{R}^{m}$</span>.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">LODEProblem(ϑ, f, ω, l, tspan, tstep, ics; kwargs...)
LODEProblem(ϑ, f, ω, l, tspan, tstep, q₀::StateVariable, p₀::StateVariable, λ₀::AlgebraicVariable; kwargs...)
LODEProblem(ϑ, f, ω, l, tspan, tstep, q₀::AbstractArray, p₀::AbstractArray, λ₀::AbstractArray = zero(q₀); kwargs...)
LODEProblem(ϑ, f, g, ω, l, tspan, tstep, ics; kwargs...)
LODEProblem(ϑ, f, g, ω, l, tspan, tstep, q₀::StateVariable, p₀::StateVariable, λ₀::AlgebraicVariable; kwargs...)
LODEProblem(ϑ, f, g, ω, l, tspan, tstep, q₀::AbstractArray, p₀::AbstractArray, λ₀::AbstractArray = zero(q₀); kwargs...)</code></pre><p>where <code>ϑ</code>, <code>f</code> and <code>g</code> are the functions computing the momentum and the vector fields, respectively, <code>ω</code> determines the symplectic matrix, and <code>l</code> returns the Lagrangian, <code>tspan</code> is the time interval <code>(t₀,t₁)</code> for the problem to be solved in, <code>tstep</code> is the time step to be used in the simulation, and <code>ics</code> is a <code>NamedTuple</code> with entries <code>q</code>, <code>p</code> and <code>λ</code>. The initial conditions <code>q₀</code>, <code>p₀</code> and <code>λ₀</code> can also be prescribed directly, with <code>StateVariable</code> an <code>AbstractArray{&lt;:Number}</code>, where <code>λ₀</code> can also be omitted. For the interfaces of the functions <code>ϑ</code>, <code>f</code>, <code>g</code>, <code>ω</code> and <code>l</code> see <a href="../equations/#GeometricEquations.LODE"><code>LODE</code></a>.</p><p>In addition to the standard keyword arguments for <a href="../problems/#GeometricEquations.EquationProblem"><code>EquationProblem</code></a> subtypes, a <code>LODEProblem</code> accepts functions <code>v̄</code> and <code>f̄</code> for the computation of initial guesses for the vector fields with default values <code>v̄ = _lode_default_v̄</code> and <code>f̄ = f</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGNI/GeometricEquations.jl/blob/291b4c440a1df9649bf3bd52b0347eb887c037eb/src/odes/lode.jl#L338-L369">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeometricEquations.SODEEnsemble" href="#GeometricEquations.SODEEnsemble"><code>GeometricEquations.SODEEnsemble</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>SODEEnsemble</code>: Split Ordinary Differential Equation Ensemble</p><p>Defines an initial value problem</p><p class="math-container">\[\dot{q} (t) = v(t, q(t)) , \qquad q(t_{0}) = q_{0} ,\]</p><p>with vector field <span>$v$</span>, initial condition <span>$q_{0}$</span> and the solution <span>$q$</span> taking values in <span>$\mathbb{R}^{d}$</span>. Here, the vector field <span>$v$</span> is given as a sum of vector fields</p><p class="math-container">\[v (t) = v_1 (t) + ... + v_r (t) .\]</p><p>The dynamical variables <span>$q$</span> take values in <span>$\mathbb{R}^{d}$</span>.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">SODEEnsemble(v, q, tspan, tstep, ics::AbstractVector{&lt;: NamedTuple}; kwargs...)
SODEEnsemble(v, q, tspan, tstep, q₀::AbstractVector{&lt;: StateVariable}; kwargs...)
SODEEnsemble(v, q, tspan, tstep, q₀::AbstractVector{&lt;: AbstractArray}; kwargs...)
SODEEnsemble(v, tspan, tstep, ics::AbstractVector{&lt;: NamedTuple}; kwargs...)
SODEEnsemble(v, tspan, tstep, q₀::AbstractVector{&lt;: StateVariable}; kwargs...)
SODEEnsemble(v, tspan, tstep, q₀::AbstractVector{&lt;: AbstractArray}; kwargs...)</code></pre><p>where <code>v</code> is a tuple of functions computing the vector fields for each substep,  <code>q</code> is an optional tuple of functions computing the solution for each substep, <code>tspan</code> is the time interval <code>(t₀,t₁)</code> for the problem to be solved in, <code>tstep</code> is the time step to be used in the simulation, and <code>ics</code> is an <code>AbstractVector</code> of <code>NamedTuple</code>, each with an entry <code>q</code> of type <code>StateVariable</code>. The initial condition <code>q₀</code> can also be prescribed as an <code>AbstractVector</code> of <code>StateVariable</code> or <code>AbstractArray{&lt;:Number}</code>. For the interface of the functions <code>v</code> and <code>q</code> see <a href="../equations/#GeometricEquations.SODE"><code>SODE</code></a>.</p><p>For possible keyword arguments see the documentation on <a href="#GeometricEquations.EnsembleProblem"><code>EnsembleProblem</code></a> subtypes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGNI/GeometricEquations.jl/blob/291b4c440a1df9649bf3bd52b0347eb887c037eb/src/odes/sode.jl#L245-L274">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../problems/">« Problems</a><a class="docs-footer-nextpage" href="../reference/">Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 7 May 2024 14:43">Tuesday 7 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
